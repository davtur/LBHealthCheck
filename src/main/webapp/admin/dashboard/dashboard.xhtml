
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="/WEB-INF/template.xhtml" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui" >


    <ui:define name="title">
        <h:outputText value="#{configMapController.getKey('ListSessionHistoryTitle')}"></h:outputText>
    </ui:define>
    <ui:define name="body">
        <h:form id="listSessionHistoryForm1">
            <p:panel id="dashboardShortcuts" header="#{configMapController.getKey('DashboardShortcutsPanelLabel')}">
                <p:commandButton id="logCashPaymentButton" oncomplete="PF('dashboardLogCashPaymentDialogueWidget').show();"  icon="fa fa-plus white Fs14"   value="#{configMapController.getKey('logCashPaymentButtonLink')}"  update=":growl " /> 

                <p:commandButton rendered="#{expensesController.isUserInRole('ADMIN')}" id="addExpenseButton" icon="fa fa-plus white Fs14"   value="#{configMapController.getKey('DashboardCreateExpenseButtonLabel')}" actionListener="#{expensesController.prepareCreate}" update=":growl " oncomplete="PF('ExpensesCreateDialogWidget').show()"/>
            </p:panel>
            <p:panel id="dashboardTimeframe" header="#{configMapController.getKey('DashboardTimeframePanelLabel')}">
                <p:panelGrid columns="4" style="width:100%"  >
                   <!-- <p:outputLabel value="#{configMapController.getKey('SelectCustomerForSessionHistory_Label')}" for="sessionstart" />-->
                    <h:panelGrid columns="3" >
                        <p:selectOneMenu id="custForChart" disabled="#{mySessionsChart1.dashboardShowAllUsers}"  value="#{mySessionsChart1.selectedCustomer}"  valueChangeListener="#{mySessionsChart1.recreateDashboardModels}"  filter="true" converter="customersControllerConverter"  label="#{configMapController.getKey('SelectCustomerForSessionHistory_Title')}" required="true" requiredMessage="#{configMapController.getKey('CreateSessionHistoryRequiredMessage_trainer')}">
                            <f:selectItems value="#{customersController.activeCustomersAndStaff}"   var="cust" itemLabel="#{cust.firstname} #{cust.lastname}" itemValue="#{cust}"/>
                            <p:ajax   update=":listSessionHistoryForm1" />
                        </p:selectOneMenu>

                        <p:selectBooleanCheckbox id="showAllUsers"   value="#{mySessionsChart1.dashboardShowAllUsers}" valueChangeListener="#{mySessionsChart1.recreateDashboardModels}" >  
                            <p:ajax update=":listSessionHistoryForm1"   />  
                        </p:selectBooleanCheckbox> 

                        <p:outputLabel  value="#{configMapController.getKey('ShowAllUsersForSessionHistory_Title')}" for="showAllUsers"/>
                    </h:panelGrid>
                    <h:panelGrid columns="2" >
                        <p:outputLabel value="#{configMapController.getKey('SelectStartDateForSessionHistory_Label')}" for="sessionstart" />
                        <p:calendar id="sessionstart" value="#{mySessionsChart1.dashboardStartDate}" pattern="dd MMMM yyyy"
                                    title="#{configMapController.getKey('SelectStartDateForSessionHistory_Title')}" valueChangeListener="#{mySessionsChart1.recreateDashboardModels}"   >
                            <p:ajax event="dateSelect"  update=":listSessionHistoryForm1"  />
                        </p:calendar> 
                    </h:panelGrid>
                    <h:panelGrid columns="2" >
                        <p:outputLabel value="#{configMapController.getKey('SelectEndDateForSessionHistory_Label')}" for="sessionend" />
                        <p:calendar id="sessionend" value="#{mySessionsChart1.dashboardEndDate}"  pattern="dd MMMM yyyy" valueChangeListener="#{mySessionsChart1.recreateDashboardModels}"
                                    title="#{configMapController.getKey('SelectEndDateForSessionHistory_Title')}"    >
                            <p:ajax event="dateSelect"  update=":listSessionHistoryForm1"  />
                        </p:calendar> 
                    </h:panelGrid>
                   <!-- <p:outputLabel value="#{configMapController.getKey('SelectDateIntervalForSessionHistory_Label')}" for="chartInterval" />-->
                    <p:selectOneMenu id="chartInterval"   value="#{mySessionsChart1.dashboardDateInterval}"   label="#{configMapController.getKey('CreateSessionHistoryTitle_trainer')}" valueChangeListener="#{mySessionsChart1.recreateDashboardModels}" >
                        <f:selectItems value="#{mySessionsChart1.dateIntervalItems}" />                         
                        <p:ajax   update=":listSessionHistoryForm1" />
                    </p:selectOneMenu>
                </p:panelGrid>
            </p:panel>
            <p:panel id="dashboardMonthlyRevenueChart" widgetVar="dashboardMonthlyRevenueWidget" header="#{configMapController.getKey('DashboardRevenueChartTitle')}">
                <p:chart type="bar"   styleClass="chartClass" model="#{mySessionsChart1.dashboardMonthlyRevenueModel}"     />
            </p:panel>

            <p:panel id="supplierExpensesChart" widgetVar="dashboardExpensesBySupplierWidget" header="#{configMapController.getKey('DashboardExpensesChartTitle')}">
                <p:chart type="bar"   styleClass="chartClass" model="#{mySessionsChart1.expensesBySupplierModel}"     >
                    <p:ajax listener="#{mySessionsChart1.supplierChartItemSelect}" event="itemSelect" update=":growl " />
                </p:chart>
            </p:panel>

            <p:panel id="customChart" widgetVar="customChartWidget" header="#{configMapController.getKey('DashboardSessionsChartTitle')}">
                <p:chart type="bar"   styleClass="chartClass" model="#{mySessionsChart1.dashboardMonthlySessionsChartModel}"     />
            </p:panel>


<!-- CUSTOMERS WITHOUT SCHEDULED PAYMENTS -->

            <div class="Container100">
                <h:outputText escape="false" value="#{configMapController.getKey('ListCustomersEmpty')}" rendered="#{customersController.customersWithoutScheduledPayments.rowCount == 0}"/>
                <h:panelGroup rendered="#{customersController.customersWithoutScheduledPayments.rowCount > 0}">
                    <p:panel id="dashboardCustWithoutPay" header="#{configMapController.getKey('DashboardNoSchedPaymentsPanelLabel')}">  
                        <p:dataTable id="customersTableList" 


                                     selection="#{customersController.multiSelectedCustomersWithoutScheduledPayments}" 
                                     rowKey="#{item.id}" 
                                     value="#{customersController.customersWithoutScheduledPayments}" 
                                     filteredValue="#{customersController.filteredCustomersWithoutScheduledPayments}" 
                                     widgetVar="customersControllerTable" 
                                     editable="false" 

                                     var="item"  
                                     scrollHeight="400"
                                     scrollable="true" >
                            <f:facet name="header">
                                <p:ajax event="filter" listener="#{customersController.onTableFiltered}"   update="@this"  />  


                                <h:panelGroup>
                                    <h:outputText value="Search all fields: " />
                                    <p:inputText id="globalFilter" onkeyup="PF('customersControllerTable').filter();"  />
                                </h:panelGroup>
                                <h:outputText value="   " />
                                <h:panelGroup  >

                                    <h:outputText  rendered="#{customersController.customersWithoutScheduledPayments != null}" value=" Records : #{customersController.customersWithoutScheduledPayments.rowCount}"/>
                                    <h:outputText  value="   (Filtered Records : #{customersController.filteredCustomersWithoutScheduledPayments.size()})">

                                    </h:outputText>

                                </h:panelGroup>

                            </f:facet>
                            <p:column sortBy="#{item.id}" filterBy="#{item.id}" headerText="#{configMapController.getKey('ListCustomersTitle_id')}"   >
                                <h:outputText value="#{item.id}"/>
                            </p:column>

                            <p:column sortBy="#{item.firstname}" filterBy="#{item.firstname}" headerText="#{configMapController.getKey('ListCustomersTitle_firstname')}"   >
                                <h:outputText value="#{item.firstname}"/>
                            </p:column>
                            <p:column sortBy="#{item.lastname}" filterBy="#{item.lastname}" headerText="#{configMapController.getKey('ListCustomersTitle_lastname')}"   >
                                <h:outputText value="#{item.lastname}"/>
                            </p:column>
                            <p:column sortBy="#{item.active.customerState}" filterBy="#{item.active.customerState}" headerText="#{configMapController.getKey('ListCustomersTitle_activeCRM')}"   >
                                <h:outputText value="LEAD, " rendered="#{customersController.isCustomerInRole(item,'LEAD')}" />  <h:outputText value="TRAINER, " rendered="#{customersController.isCustomerInRole(item,'TRAINER')}" /> <h:outputText value="#{item.active.customerState}"/>                                       
                            </p:column>
                            <p:column sortBy="#{item.paymentParameters.statusDescription}" filterBy="#{item.paymentParameters.statusDescription}" headerText="#{configMapController.getKey('ListCustomersTitle_activeEZI')}"   >
                                <h:outputText value="#{item.paymentParameters.statusDescription}"/> 
                            </p:column>
                            <p:column sortBy="#{item.groupPricing.planName}" filterBy="#{item.groupPricing.planName}" headerText="#{configMapController.getKey('CreateCustomersTitle_groupPricing')}"   >
                                <h:outputText value="#{item.groupPricing.planName} - #{item.groupPricing.planPrice}"/> 
                            </p:column>
                            <p:column sortBy="#{item.paymentParameters.contractStartDate}" filterBy="#{item.paymentParameters.contractStartDate}" headerText="#{configMapController.getKey('ListCustomersTitle_contractStartDate')}"   >
                                <h:outputText value="#{item.paymentParameters.contractStartDate}">
                                    <f:convertDateTime pattern="dd MMM yyyy" />
                                </h:outputText>
                            </p:column>
                            <p:column sortBy="#{item.paymentParameters.paymentPeriod}" filterBy="#{item.paymentParameters.paymentPeriod}" headerText="#{configMapController.getKey('ListCustomersTitle_paymentPeriod')}"   >

                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'F'}"  value="Fortnightly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'M'}"  value="Monthly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == '4'}"  value="4 Weekly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'N'}"  value="Weekday in Month" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'Q'}"  value="Quarterly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'H'}"  value="Half Yearly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'Y'}"  value="Annually" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'W'}"  value="Weekly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'Z'}"  value="No Schedule" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod != 'Z' and item.paymentParameters.paymentPeriod != 'M' and item.paymentParameters.paymentPeriod != 'Q' and item.paymentParameters.paymentPeriod != 'H' and item.paymentParameters.paymentPeriod != 'Y' }"  value=" - #{item.paymentParameters.paymentPeriodDayOfWeek}"/> 
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod != 'Z' and item.paymentParameters.paymentPeriod == 'M' }"  value=", day-#{item.paymentParameters.paymentPeriodDayOfMonth}"/> 

                            </p:column>
                            <p:column sortBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.lastUpdatedDatetime}" filterBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.lastUpdatedDatetime}" headerText="#{configMapController.getKey('ListCustomersTitle_lastUpdated')}"   >
                                <h:outputText  rendered="#{not empty item.paymentParameters.lastSuccessfulScheduledPayment}"  value="#{item.paymentParameters.lastSuccessfulScheduledPayment.lastUpdatedDatetime}">
                                    <f:convertDateTime  pattern="yyyy-MM-dd hh:mm:ss" />
                                </h:outputText>
                                <h:outputText rendered="#{empty item.paymentParameters.lastSuccessfulScheduledPayment}" value="---"/>
                            </p:column>

                            <p:column sortBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.paymentAmount}" filterBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.paymentAmount}" headerText="#{configMapController.getKey('ListCustomersTitle_totalPaymentsSuccessfulAmount')}"   >
                                <h:outputText rendered="#{not empty item.paymentParameters.lastSuccessfulScheduledPayment}" value="#{item.paymentParameters.lastSuccessfulScheduledPayment.paymentAmount}">
                                    <f:convertNumber type="currency" currencySymbol="$" locale="au-AU" />
                                </h:outputText>
                            </p:column>
                            <p:column  sortBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.debitDate}" filterBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.debitDate}" headerText="#{configMapController.getKey('ListCustomersTitle_lastSuccessfulScheduledPayment')}"   >
                                <h:outputText rendered="#{not empty item.paymentParameters.lastSuccessfulScheduledPayment}" value="#{item.paymentParameters.lastSuccessfulScheduledPayment.debitDate}">
                                    <f:convertDateTime pattern="E dd MMM yyyy" />
                                </h:outputText>
                                <h:outputText rendered="#{empty item.paymentParameters.lastSuccessfulScheduledPayment}" value="---"/>
                            </p:column>




                        </p:dataTable>
                    </p:panel>
                </h:panelGroup>

            </div>
<!-- LEADS -->

            <div class="Container100">
                <h:outputText escape="false" value="#{configMapController.getKey('ListCustomersEmpty')}" rendered="#{customersController.leads.rowCount == 0}"/>
                <h:panelGroup rendered="#{customersController.leads.rowCount > 0}">
                    <p:panel id="dashboardLeads" header="#{configMapController.getKey('DashboardLeadsPanelLabel')}">  
                        <p:dataTable id="leadsTableList" 


                                     selection="#{customersController.multiSelectedLeads}" 
                                     rowKey="#{item.id}" 
                                     value="#{customersController.leads}" 
                                     filteredValue="#{customersController.filteredLeads}" 
                                     widgetVar="leadsControllerTable" 
                                     editable="false" 

                                     var="item"  
                                     scrollHeight="400"
                                     scrollable="true" >
                            <f:facet name="header">
                                <p:ajax event="filter" listener="#{customersController.onTableFiltered}"   update="@this"  />  


                                <h:panelGroup>
                                    <h:outputText value="Search all fields: " />
                                    <p:inputText id="globalFilter" onkeyup="PF('leadsControllerTable').filter();"  />
                                </h:panelGroup>
                                <h:outputText value="   " />
                                <h:panelGroup  >

                                    <h:outputText  rendered="#{customersController.customersWithoutScheduledPayments != null}" value=" Records : #{customersController.customersWithoutScheduledPayments.rowCount}"/>
                                    <h:outputText  value="   (Filtered Records : #{customersController.filteredCustomersWithoutScheduledPayments.size()})">

                                    </h:outputText>

                                </h:panelGroup>

                            </f:facet>
                            <p:column sortBy="#{item.id}" filterBy="#{item.id}" headerText="#{configMapController.getKey('ListCustomersTitle_id')}"   >
                                <h:outputText value="#{item.id}"/>
                            </p:column>

                            <p:column sortBy="#{item.firstname}" filterBy="#{item.firstname}" headerText="#{configMapController.getKey('ListCustomersTitle_firstname')}"   >
                                <h:outputText value="#{item.firstname}"/>
                            </p:column>
                            <p:column sortBy="#{item.lastname}" filterBy="#{item.lastname}" headerText="#{configMapController.getKey('ListCustomersTitle_lastname')}"   >
                                <h:outputText value="#{item.lastname}"/>
                            </p:column>
                            <p:column sortBy="#{item.active.customerState}" filterBy="#{item.active.customerState}" headerText="#{configMapController.getKey('ListCustomersTitle_activeCRM')}"   >
                                <h:outputText value="LEAD, " rendered="#{customersController.isCustomerInRole(item,'LEAD')}" />  <h:outputText value="TRAINER, " rendered="#{customersController.isCustomerInRole(item,'TRAINER')}" /> <h:outputText value="#{item.active.customerState}"/>                                       
                            </p:column>
                            <p:column sortBy="#{item.paymentParameters.statusDescription}" filterBy="#{item.paymentParameters.statusDescription}" headerText="#{configMapController.getKey('ListCustomersTitle_activeEZI')}"   >
                                <h:outputText value="#{item.paymentParameters.statusDescription}"/> 
                            </p:column>
                            <p:column sortBy="#{item.groupPricing.planName}" filterBy="#{item.groupPricing.planName}" headerText="#{configMapController.getKey('CreateCustomersTitle_groupPricing')}"   >
                                <h:outputText value="#{item.groupPricing.planName} - #{item.groupPricing.planPrice}"/> 
                            </p:column>
                            <p:column sortBy="#{item.paymentParameters.contractStartDate}" filterBy="#{item.paymentParameters.contractStartDate}" headerText="#{configMapController.getKey('ListCustomersTitle_contractStartDate')}"   >
                                <h:outputText value="#{item.paymentParameters.contractStartDate}">
                                    <f:convertDateTime pattern="dd MMM yyyy" />
                                </h:outputText>
                            </p:column>
                            <p:column sortBy="#{item.paymentParameters.paymentPeriod}" filterBy="#{item.paymentParameters.paymentPeriod}" headerText="#{configMapController.getKey('ListCustomersTitle_paymentPeriod')}"   >

                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'F'}"  value="Fortnightly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'M'}"  value="Monthly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == '4'}"  value="4 Weekly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'N'}"  value="Weekday in Month" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'Q'}"  value="Quarterly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'H'}"  value="Half Yearly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'Y'}"  value="Annually" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'W'}"  value="Weekly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'Z'}"  value="No Schedule" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod != 'Z' and item.paymentParameters.paymentPeriod != 'M' and item.paymentParameters.paymentPeriod != 'Q' and item.paymentParameters.paymentPeriod != 'H' and item.paymentParameters.paymentPeriod != 'Y' }"  value=" - #{item.paymentParameters.paymentPeriodDayOfWeek}"/> 
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod != 'Z' and item.paymentParameters.paymentPeriod == 'M' }"  value=", day-#{item.paymentParameters.paymentPeriodDayOfMonth}"/> 

                            </p:column>
                            <p:column sortBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.lastUpdatedDatetime}" filterBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.lastUpdatedDatetime}" headerText="#{configMapController.getKey('ListCustomersTitle_lastUpdated')}"   >
                                <h:outputText  rendered="#{not empty item.paymentParameters.lastSuccessfulScheduledPayment}"  value="#{item.paymentParameters.lastSuccessfulScheduledPayment.lastUpdatedDatetime}">
                                    <f:convertDateTime  pattern="yyyy-MM-dd hh:mm:ss" />
                                </h:outputText>
                                <h:outputText rendered="#{empty item.paymentParameters.lastSuccessfulScheduledPayment}" value="---"/>
                            </p:column>

                            <p:column sortBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.paymentAmount}" filterBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.paymentAmount}" headerText="#{configMapController.getKey('ListCustomersTitle_totalPaymentsSuccessfulAmount')}"   >
                                <h:outputText rendered="#{not empty item.paymentParameters.lastSuccessfulScheduledPayment}" value="#{item.paymentParameters.lastSuccessfulScheduledPayment.paymentAmount}">
                                    <f:convertNumber type="currency" currencySymbol="$" locale="au-AU" />
                                </h:outputText>
                            </p:column>
                            <p:column  sortBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.debitDate}" filterBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.debitDate}" headerText="#{configMapController.getKey('ListCustomersTitle_lastSuccessfulScheduledPayment')}"   >
                                <h:outputText rendered="#{not empty item.paymentParameters.lastSuccessfulScheduledPayment}" value="#{item.paymentParameters.lastSuccessfulScheduledPayment.debitDate}">
                                    <f:convertDateTime pattern="E dd MMM yyyy" />
                                </h:outputText>
                                <h:outputText rendered="#{empty item.paymentParameters.lastSuccessfulScheduledPayment}" value="---"/>
                            </p:column>




                        </p:dataTable>
                    </p:panel>
                </h:panelGroup>

            </div>
<!-- ON HOLD -->

            <div class="Container100">
                <h:outputText escape="false" value="#{configMapController.getKey('ListCustomersEmpty')}" rendered="#{customersController.leads.rowCount == 0}"/>
                <h:panelGroup rendered="#{customersController.leads.rowCount > 0}">
                    <p:panel id="dashboardOnHold" header="#{configMapController.getKey('DashboardCustomersOnHoldPanelLabel')}">  
                        <p:dataTable id="customersOnHoldTableList" 


                                     selection="#{customersController.multiSelectedCustomersOnHold}" 
                                     rowKey="#{item.id}" 
                                     value="#{customersController.customersOnHold}" 
                                     filteredValue="#{customersController.filteredCustomersOnHold}" 
                                     widgetVar="customersOnHoldControllerTable" 
                                     editable="false" 

                                     var="item"  
                                     scrollHeight="400"
                                     scrollable="true" >
                            <f:facet name="header">
                                <p:ajax event="filter" listener="#{customersController.onTableFiltered}"   update="@this"  />  


                                <h:panelGroup>
                                    <h:outputText value="Search all fields: " />
                                    <p:inputText id="globalFilter" onkeyup="PF('customersOnHoldControllerTable').filter();"  />
                                </h:panelGroup>
                                <h:outputText value="   " />
                                <h:panelGroup  >

                                    <h:outputText  rendered="#{customersController.customersWithoutScheduledPayments != null}" value=" Records : #{customersController.customersWithoutScheduledPayments.rowCount}"/>
                                    <h:outputText  value="   (Filtered Records : #{customersController.filteredCustomersWithoutScheduledPayments.size()})">

                                    </h:outputText>

                                </h:panelGroup>

                            </f:facet>
                            <p:column sortBy="#{item.id}" filterBy="#{item.id}" headerText="#{configMapController.getKey('ListCustomersTitle_id')}"   >
                                <h:outputText value="#{item.id}"/>
                            </p:column>

                            <p:column sortBy="#{item.firstname}" filterBy="#{item.firstname}" headerText="#{configMapController.getKey('ListCustomersTitle_firstname')}"   >
                                <h:outputText value="#{item.firstname}"/>
                            </p:column>
                            <p:column sortBy="#{item.lastname}" filterBy="#{item.lastname}" headerText="#{configMapController.getKey('ListCustomersTitle_lastname')}"   >
                                <h:outputText value="#{item.lastname}"/>
                            </p:column>
                            <p:column sortBy="#{item.active.customerState}" filterBy="#{item.active.customerState}" headerText="#{configMapController.getKey('ListCustomersTitle_activeCRM')}"   >
                                <h:outputText value="LEAD, " rendered="#{customersController.isCustomerInRole(item,'LEAD')}" />  <h:outputText value="TRAINER, " rendered="#{customersController.isCustomerInRole(item,'TRAINER')}" /> <h:outputText value="#{item.active.customerState}"/>                                       
                            </p:column>
                            <p:column sortBy="#{item.paymentParameters.statusDescription}" filterBy="#{item.paymentParameters.statusDescription}" headerText="#{configMapController.getKey('ListCustomersTitle_activeEZI')}"   >
                                <h:outputText value="#{item.paymentParameters.statusDescription}"/> 
                            </p:column>
                            <p:column sortBy="#{item.groupPricing.planName}" filterBy="#{item.groupPricing.planName}" headerText="#{configMapController.getKey('CreateCustomersTitle_groupPricing')}"   >
                                <h:outputText value="#{item.groupPricing.planName} - #{item.groupPricing.planPrice}"/> 
                            </p:column>
                            <p:column sortBy="#{item.paymentParameters.contractStartDate}" filterBy="#{item.paymentParameters.contractStartDate}" headerText="#{configMapController.getKey('ListCustomersTitle_contractStartDate')}"   >
                                <h:outputText value="#{item.paymentParameters.contractStartDate}">
                                    <f:convertDateTime pattern="dd MMM yyyy" />
                                </h:outputText>
                            </p:column>
                            <p:column sortBy="#{item.paymentParameters.paymentPeriod}" filterBy="#{item.paymentParameters.paymentPeriod}" headerText="#{configMapController.getKey('ListCustomersTitle_paymentPeriod')}"   >

                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'F'}"  value="Fortnightly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'M'}"  value="Monthly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == '4'}"  value="4 Weekly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'N'}"  value="Weekday in Month" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'Q'}"  value="Quarterly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'H'}"  value="Half Yearly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'Y'}"  value="Annually" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'W'}"  value="Weekly" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod == 'Z'}"  value="No Schedule" />
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod != 'Z' and item.paymentParameters.paymentPeriod != 'M' and item.paymentParameters.paymentPeriod != 'Q' and item.paymentParameters.paymentPeriod != 'H' and item.paymentParameters.paymentPeriod != 'Y' }"  value=" - #{item.paymentParameters.paymentPeriodDayOfWeek}"/> 
                                <h:outputText  rendered="#{item.paymentParameters.paymentPeriod != 'Z' and item.paymentParameters.paymentPeriod == 'M' }"  value=", day-#{item.paymentParameters.paymentPeriodDayOfMonth}"/> 

                            </p:column>
                            <p:column sortBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.lastUpdatedDatetime}" filterBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.lastUpdatedDatetime}" headerText="#{configMapController.getKey('ListCustomersTitle_lastUpdated')}"   >
                                <h:outputText  rendered="#{not empty item.paymentParameters.lastSuccessfulScheduledPayment}"  value="#{item.paymentParameters.lastSuccessfulScheduledPayment.lastUpdatedDatetime}">
                                    <f:convertDateTime  pattern="yyyy-MM-dd hh:mm:ss" />
                                </h:outputText>
                                <h:outputText rendered="#{empty item.paymentParameters.lastSuccessfulScheduledPayment}" value="---"/>
                            </p:column>

                            <p:column sortBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.paymentAmount}" filterBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.paymentAmount}" headerText="#{configMapController.getKey('ListCustomersTitle_totalPaymentsSuccessfulAmount')}"   >
                                <h:outputText rendered="#{not empty item.paymentParameters.lastSuccessfulScheduledPayment}" value="#{item.paymentParameters.lastSuccessfulScheduledPayment.paymentAmount}">
                                    <f:convertNumber type="currency" currencySymbol="$" locale="au-AU" />
                                </h:outputText>
                            </p:column>
                            <p:column  sortBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.debitDate}" filterBy="#{item.paymentParameters.lastSuccessfulScheduledPayment.debitDate}" headerText="#{configMapController.getKey('ListCustomersTitle_lastSuccessfulScheduledPayment')}"   >
                                <h:outputText rendered="#{not empty item.paymentParameters.lastSuccessfulScheduledPayment}" value="#{item.paymentParameters.lastSuccessfulScheduledPayment.debitDate}">
                                    <f:convertDateTime pattern="E dd MMM yyyy" />
                                </h:outputText>
                                <h:outputText rendered="#{empty item.paymentParameters.lastSuccessfulScheduledPayment}" value="---"/>
                            </p:column>




                        </p:dataTable>
                    </p:panel>
                </h:panelGroup>

            </div>

        </h:form>
        <ui:include src="/admin/expenses/Create.xhtml"/>
        <ui:include src="LogCashPaymentFull.xhtml"/>
    </ui:define>

</ui:composition>


