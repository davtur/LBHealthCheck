<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:pm="http://primefaces.org/mobile">

    <f:view renderKitId="PRIMEFACES_MOBILE" />
    <h:head>
    </h:head>

    <h:body>
        <p:growl id="growl" showDetail="true"/>
        <pm:page id="main" title="My Statistics" >

            <!-- Main View  -->
            <pm:header title="My Statistics"  swatch="b">
                <f:facet name="left">
                    <h:form>
                        <p:commandButton value="Back" style="width:100px" icon="back" action="/mobileMenu?faces-redirect=true" ajax="false"/>
                    </h:form>
                </f:facet>
            </pm:header>  
            <pm:content > 
                <h:form id="myStatsForm">
                    <p:panel header="Welcome #{chartController.customer.firstname}" >
                        <p:panel class="customerDetailsPanel parentOfUploadPhoto profilePictureContainer" header="#{configMapController.getKey('ListCustomersTitle_ProfilePic')}" >

                            <p:graphicImage id="photo1"  value="#{customersController.selected.profileImage.imageStream}"  cache="false" class="profilePicture"/>
                            <p:commandButton  id="photoUploadButton" action="pm:uploadPhoto"    value="#{configMapController.getKey('EditCustomersUploadPhotoButton')}" />

                        </p:panel>
                       <!--    <p:panel id ="contentFlowPanel"  header="My Pictures : #{customerImagesController.imageListSize} loaded." >
                            <p:contentFlow id="mainCarousel" class="myStatsCarousel parentOfUploadPhoto"  value="#{customerImagesController.images}" var="image"  style="height: 400px" widgetVar="contentFlowWidget" >

                                <p:graphicImage  styleClass="content" value="#{customerImagesController.image}" onclick="clickFlow(this, event)" title="#{configMapController.getKey('ListMyStats_photoTakenText')} #{image.formattedDate}" alt="#{customerImagesController.dynamicTitle}" cache="false">
                                    <f:param name="imageId" value="#{image.id}"/>
                                </p:graphicImage>

                                <div class="caption">#{image.formattedDate}</div>
                                <div class="hiddenId" style="display: none;">#{image.id}</div>
                            </p:contentFlow>
                            <p:contextMenu  for="mainCarousel" >
                                <p:menuitem value="Refresh" update=":main:myStatsForm:contentFlowPanel" />
                                <p:separator/>
                                <p:menuitem value="Add New" action="pm:uploadPhoto" />
                                <p:menuitem value="Delete" oncomplete="removePicture([{name:'selectedImage', value: $('.item.active div.hiddenId').text()}]);" />
                            </p:contextMenu>
                            <p:remoteCommand name="removePicture" actionListener="#{customerImagesController.removePicture}" update=":main:myStatsForm:contentFlowPanel"/>
                        </p:panel> -->


                    </p:panel>
                    <p:remoteCommand  actionListener="#{customerImagesController.carouselImageClicked}"  name="carouselClicked" immediate="true"/>

                    <script>
                        function clickFlow(item, e) {
                            if ($(item).parent().hasClass('active')) {
                                e.stopImmediatePropagation();
                            }
                        }
                    </script>
                    <!--  <p:panel >
                         <p:lightBox styleClass="imagebox" height="400">
                             <ui:repeat var="image" value="#{customerImagesController.images}" >
                                 <h:outputLink value="#{customerImagesController.image}"  >
                                     <p:graphicImage value="#{customerImagesController.image}" >
                                                    
                                     <f:param name="imageId" value="#{image.id}"/>
                                        </p:graphicImage>
                                 </h:outputLink>
                             </ui:repeat>
     
     
     
     
     
                         </p:lightBox>
     
                     </p:panel>-->


                   <!--     <p:carousel class="myStatsCarousel parentOfUploadPhoto" widgetVar="myStatsCarouselWidget" id="photoGalleryCarousel" value="#{customerImagesController.images}" headerText="#{configMapController.getKey('ListMyStats_GalleryHeader')}" var="image" numVisible="6" autoPlayInterval="0" effectDuration="2000" effect="elasticBoth" circular="false" >-->
                       <!--  <p:contentFlow class="myStatsCarousel parentOfUploadPhoto" value="#{customerImagesController.images}" var="image">
                             <f:facet name="header" >
                                  <p:commandButton onclick="PF('myStatsCarouselWidget').startAutoplay()"   icon="fa fa-play-circle-o" /> 
                                  <p:commandButton onclick="PF('myStatsCarouselWidget').stopAutoplay()" icon="fa fa-stop" />
  
  
                              </f:facet>
                              <p:panel class="customerDetailsPanel"  header="#{configMapController.getKey('ListMyStats_photoTakenText')}  #{image.formattedDate}">
                            <p:graphicImage styleClass="content" value="#{customerImagesController.dynamicImage}"  title="#{configMapController.getKey('ListMyStats_photoTakenText')} #{image.formattedDate}" alt="#{customerImagesController.dynamicTitle}">
                                <f:param name="imageid" value="#{image.id}"/>
                                <f:param name="imagedescid" value="#{image.id}"/>
                                <f:param name="imagetitleid" value="#{image.id}"/>
                            </p:graphicImage>
                            <div class="caption">#{image.formattedDate}</div>-->
                    <!--      <h:panelGrid columns="1">
                            <p:commandButton update="@(.parentOfUploadPhoto) :growl"  value="Delete">
    
                                <f:setPropertyActionListener value="#{image}" target="#{customerImagesController.selectedForDeletion}" />
                            </p:commandButton>
                        </h:panelGrid>
                    </p:panel>
                    </p:carousel>
                </p:contentFlow>-->
                    <p:panel >
                        <p:dataGrid widgetVar="photosWidget" var="image" pt:data-inset="true"  rows="1" value="#{customerImagesController.images}" emptyMessage="No Photos to display. Please upload some." >

                             <p:graphicImage  styleClass="content" value="#{customerImagesController.image}" onclick="clickFlow(this, event)" title="#{configMapController.getKey('ListMyStats_photoTakenText')} #{image.formattedDate}" alt="#{customerImagesController.dynamicTitle}" cache="false">
                                    <f:param name="imageId" value="#{image.id}"/>
                                </p:graphicImage>


                        </p:dataGrid>
                    </p:panel>
                    
                  <!--    <p:panel >
                        <p:galleria widgetVar="galleriaWidget" var="image" value="#{customerImagesController.images}"  showCaption="true" effect="#{customerImagesController.effect}" effectSpeed="1000">

                             <p:graphicImage  styleClass="content" value="#{customerImagesController.image}" onclick="clickFlow(this, event)" title="#{configMapController.getKey('ListMyStats_photoTakenText')} #{image.formattedDate}" alt="#{customerImagesController.dynamicTitle}" cache="false">
                                    <f:param name="imageId" value="#{image.id}"/>
                                </p:graphicImage>


                        </p:galleria>
                    </p:panel>
                    <p:panel class="customerDetailsPanel" header="#{configMapController.getKey('ListMyStats_SelectedPic')}">
                        <h:panelGrid columns="1">
                            <p:graphicImage id="photo2" value="#{customerImagesController.selected.imageStream}" height="200px" cache="false" />
                            <p:commandButton  id="photoUploadButton2" ajax="true"  onclick="PF('uploadPhotoDialogueWidget').show();" update=":growl :uploadPhotoForm"   value="#{configMapController.getKey('EditCustomersUploadPhotoButton')}" immediate="true"/>
                        </h:panelGrid>-->

                    <!--  <p:panel header="Photo Gallery" style="height: 500px">
                       <p:ring id="basic" value="#{customerImagesController.images}" var="image" easing="easeInOutCirc">
                           <p:column>
                    #{image.formattedDate}
                     
                     <p:graphicImage value="#{customerImagesController.dynamicImage}"  title="This photo was taken on #{image.formattedDate}" width="200px"> 
                        <f:param name="imageid" value="#{image.id}"/>
                         </p:graphicImage>
                      <p:graphicImage value="#{customerImagesController.dynamicImage}"  title="This photo was taken on #{image.formattedDate}" alt="#{customerImagesController.dynamicTitle}">
                         <f:param name="imageid" value="#{image.id}"/>
                         <f:param name="imagedescid" value="#{image.id}"/>
                         <f:param name="imagetitleid" value="#{image.id}"/>
                     </p:graphicImage>
                    <p:commandButton update=":form:carDetail" icon="ui-icon-search" title="View" oncomplete="PF('carDialog').show();">
                          <f:setPropertyActionListener value="#{image}" target="#{ringView.selectedCar}" />
                      </p:commandButton>
                 </p:column>
             </p:ring>
         </p:panel>-->


                </h:form>
                <h:form>

                    <p:panel header="#{configMapController.getKey('ListMyStats_StatsPanelHeader')}">
                        <p:dataList  value="#{chartController.modelList}"  var="chart" id="chartsList"  
                                     pt:data-inset="true" paginator="true" rows="5">

                            <p:panel header="#{chart.title}">                    
                                <p:chart type="line" styleClass="chartClass"  model="#{chart}"/>
                            </p:panel>

                        </p:dataList>
                    </p:panel>
                </h:form>

            </pm:content>

        </pm:page>

        <pm:page id="uploadPhoto">
            <pm:header title="#{configMapController.getKey('uploadPhotoDialogueTitle')}"></pm:header>
            <pm:content>
                <!--  <h:form id="uploadPhotoForm">                   
                      <p:fileUpload fileLimitMessage="The size of the picture is too big! ( > 10MB )" mode="advanced" fileUploadListener="#{customerImagesController.handleFileUpload}" auto="true" update=":uploadPhoto:uploadPhotoForm:panel3  :growl" allowTypes="/(\.|\/)(gif|jpe?g|png)$/" sizeLimit="10000000" />
                      <p:panel id="panel3" class="parentOfUploadPhoto" >
                          <h:panelGrid columns="1">
                              <p:graphicImage id="uploadedPhoto"  class="dialoguePhoto parentOfUploadPhoto" value="#{customerImagesController.uploadedImageAsStream}" style="max-width: 200px" cache="false" >
  
                              </p:graphicImage>
  
                              <pe:imageAreaSelect id="areaSelect" class="dialoguePhoto parentOfUploadPhoto"  for="uploadedPhoto"  handles="true"  widgetVar="areaSelectWidget"  >  
                                  <p:ajax event="selectEnd" listener="#{customerImagesController.selectEndListener}" update=":growl"/>  
                              </pe:imageAreaSelect> 
                          </h:panelGrid>
                          <h:panelGrid columns="5">
                              <p:outputLabel  value="#{configMapController.getKey('CreateCustomerImagesLabel_profilephoto')}" for="profilephoto" />
                              <p:selectBooleanCheckbox id="profilephoto"  class="parentOfUploadPhoto" disabled="#{customerImagesController.saveButtonDisabled}"  value="#{customerImagesController.profilePhoto}" >
                                  <p:ajax event="change" />
                              </p:selectBooleanCheckbox>  
                              <p:commandButton id="saveButton" class="parentOfUploadPhoto" disabled="#{customerImagesController.saveButtonDisabled}"  actionListener="#{customerImagesController.createFromUploadDialogue}" update="@(.parentOfUploadPhoto) :growl"   value="#{configMapController.getKey('CreateCustomerImagesSaveLink')}" />
                              <p:commandButton id="rotateButton"   class="parentOfUploadPhoto"  disabled="#{customerImagesController.saveButtonDisabled}"   actionListener="#{customerImagesController.rotateStreamedContent90degrees}" update=":uploadPhoto:uploadPhotoForm:panel3 :growl"  value="#{configMapController.getKey('CreateCustomerImagesRotateImage90Link')}" />
                              <p:commandButton id="cropButton"  class="parentOfUploadPhoto" disabled="#{customerImagesController.saveButtonDisabled}" actionListener="#{customerImagesController.crop}"  update=":uploadPhoto:uploadPhotoForm:panel3  :growl"  value="#{configMapController.getKey('CreateCustomerImagesCropLink')}"  />
                          </h:panelGrid>
                      </p:panel>
                      <p:commandButton  id="closeDialogueButton"  action="pm:main"  value="#{configMapController.getKey('EditCustomersuploadPhoto')}" immediate="true"/>
                  </h:form>-->

                <h:form id="photoCreate2" enctype="multipart/form-data">
                    <p:graphicImage id="uploadedPhoto"  class="dialoguePhoto parentOfUploadPhoto" value="#{customerImagesController.uploadedImageAsStream}" style="max-width: 300px" cache="false" >

                    </p:graphicImage>
                    <p:fileUpload  id="uploader" previewWidth="200"  fileLimitMessage="The size of the picture is too big! ( > 5 MB )" mode="simple" value="#{customerImagesController.uploadedFile}" auto="true" update=":uploadPhoto:photos:photoCreate :growl" allowTypes="/(\.|\/)(gif|jpe?g|png)$/" sizeLimit="5000000" required="true"  requiredMessage="You need to upload a photo."/>
                    <p:spacer height="10em" />
                    <p:commandButton  ajax="false"  actionListener="#{customerImagesController.createFromMobile}" value="#{configMapController.getKey('CreateCustomerImagesSaveLink')}" />
                </h:form>
                <h:form id="photoCreate" >
                    <p:selectBooleanCheckbox id="profilephoto" immediate="true"  value="#{customerImagesController.profilePhoto}" itemLabel="#{configMapController.getKey('CreateCustomerImagesLabel_profilephoto')}">
                        <p:ajax />
                    </p:selectBooleanCheckbox>  

                    <p:spacer height="10em" />
                    <p:commandButton  id="closeDialogueButton"  action="pm:main"  value="#{configMapController.getKey('EditCustomersuploadPhoto')}" immediate="true"/>
                </h:form>

            </pm:content>
        </pm:page>


    </h:body>
</html>


