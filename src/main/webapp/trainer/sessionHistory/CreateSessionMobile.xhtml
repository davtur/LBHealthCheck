<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pm="http://primefaces.org/mobile">

    <f:view renderKitId="PRIMEFACES_MOBILE" />


    <h:head>

    </h:head>

    <h:body>


        <!-- Main View  -->
        <pm:page id="sessions"  title="Training Session" >

            <pm:header  swatch="b" title="Log Training Session"  rendered="#{empty sessionHistoryController.selected.id}">

                <f:facet name="left"><h:form><p:commandButton value="Back" style="width:100px" icon="back" action="/mobileMenu?faces-redirect=true" ajax="false"/></h:form></f:facet>
            </pm:header>  
            <pm:header  swatch="b" title="Edit Session" rendered="#{not empty sessionHistoryController.selected.id}">

                <f:facet name="left"><h:form><p:commandButton value="Back" style="width:100px" icon="back" action="/mobileMenu?faces-redirect=true" ajax="false"/></h:form></f:facet>
            </pm:header>  

            <pm:content >            

                <h:form id="sessionsForm">  
                    <p:growl  showDetail="true"/>
  
                    <p:spacer height="10em" />

                    <pm:field>
                        <p:outputLabel for="sessiondate" value="#{configMapController.getKey('CreateSessionHistoryLabel_sessiondate')}" />
                        <p:calendar id="sessiondate" value="#{sessionHistoryController.selected.sessiondate}"  pattern="dd/MM/yyyy" >

                        </p:calendar>
                    </pm:field>  
                    <pm:field>

                        <h:outputLabel for="ajaxSpinner" value="Hour: " />
                        <pm:inputSlider id="ajaxSpinner" minValue="0" maxValue="23" valueChangeListener="#{sessionHistoryController.hourSpinnerChange}"  value="#{sessionHistoryController.hourSpinner}"/>
                    </pm:field>  
                    <pm:field>   
                        <h:outputLabel for="ajaxSpinner2" value="Minute: " />
                        <pm:inputSlider id="ajaxSpinner2" minValue="0" maxValue="55"  valueChangeListener="#{sessionHistoryController.minuteSpinnerChange}"  step="5" value="#{sessionHistoryController.minuteSpinner}"/>
                    </pm:field>  


                    <p:spacer height="10em" />

                    <pm:field>
                        <p:outputLabel for="sessionType" value="#{configMapController.getKey('CreateSessionHistoryLabel_sessionType')}" />
                        <p:selectOneMenu id="sessionType" value="#{sessionHistoryController.selected.sessionTypesId}" label="#{configMapController.getKey('CreateSessionHistoryLabel_sessionType')}"  converter="#{sessionTypesConverter}" required="true" requiredMessage="#{configMapController.getKey('CreateSessionHistoryRequiredMessage_sessionType')}">
                            <f:selectItems value="#{sessionTypesController.itemsAvailable}" />
                        </p:selectOneMenu>
                    </pm:field>

                    <p:spacer height="10em" />

                    <pm:field>
                        <p:outputLabel for="sessionType" value="#{configMapController.getKey('CreateSessionHistoryLabel_trainer')}" />
                        <p:selectCheckboxMenu id="trainer" filter="true" filterMatchMode="startsWith"  value="#{sessionHistoryController.trainers}" converter="#{custConverter}" label="#{configMapController.getKey('CreateSessionHistoryLabel_trainer')}" required="true" requiredMessage="#{configMapController.getKey('CreateSessionHistoryRequiredMessage_trainer')}">
                            <f:selectItems value="#{sessionHistoryController.activeTrainers}" var="cust" itemLabel="#{cust.firstname} #{cust.lastname}" itemValue="#{cust}"/>
                        </p:selectCheckboxMenu>
                    </pm:field>
                    <p:spacer height="10em" />
                    <pm:field>
                        <p:outputLabel for="adminnotes" value="#{configMapController.getKey('CreateSessionHistoryLabel_adminNotes')}" />
                        <p:inputTextarea id="adminnotes" value="#{sessionHistoryController.selected.adminNotes}"  />
                    </pm:field>
                    <p:spacer height="10em" />
                    <pm:field>
                        <p:outputLabel for="comments" value="#{configMapController.getKey('CreateSessionHistoryLabel_comments')}" />
                        <p:inputTextarea id="comments" value="#{sessionHistoryController.selected.comments}"  />
                    </pm:field>
                    <p:spacer height="10em"  />
                    <pm:field>
                        <p:outputLabel for="attendanceCount" value="#{configMapController.getKey('CreateSessionHistoryLabel_picker')}" />
                        <p:panel id="attendanceCount"  >
                            <f:facet name="header">
                                <h:outputText id="attendanceCount1" value="#{configMapController.getKey('CreateSessionHistoryLabel_totalSelected')}#{sessionHistoryController.numberThatAttendedSession}"/>
                            </f:facet>
                            <p:dataList  id="scroll"   value="#{sessionHistoryController.selectableActiveCustomers}" var="cust" rowIndexVar="rowIndex"  >
                                <!-- <f:attribute name="filter" value="true" />-->
                                <p:column>
                                    <h:panelGrid id="customerPanel" columns="3" >
                                        <p:graphicImage value="#{customerImagesController.dynamicImage}" width="50px">
                                            <f:param name="imageId" value="#{cust.profileImage.id}"/>
                                        </p:graphicImage>
                                        <p:selectBooleanCheckbox id="btnAttendedSession" value="#{sessionHistoryController.checkedCustomers[rowIndex]}"  style="text-align: right">
                                            <p:ajax update=":sessions:sessionsForm:attendanceCount1 :sessions:sessionsForm:bottomButton "  event="change" />
                                        </p:selectBooleanCheckbox>
                                        <h:outputText value="#{cust.firstname} #{cust.lastname}" style="padding-left: 30px"/>
                                    </h:panelGrid>
                                </p:column>
                            </p:dataList>
                            <p:spacer height="10em" />
                            

                        </p:panel>
                    </pm:field>
                    <p:spacer height="10em" />
                   
                    <p:spacer height="10em" />
                    <p:commandButton  id="bottomButton" ajax="false"   action="#{sessionHistoryController.createMobileDatalist}" value="#{configMapController.getKey('CreateSessionMobileSaveButton')} #{sessionHistoryController.numberThatAttendedSession}" />
                </h:form>
            </pm:content>
        </pm:page>
    </h:body>
</html>
